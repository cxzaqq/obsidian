
# 2.1 인터넷의 리소스 탐색하기

`http://www.joes-hardware.com/seasonal/index-fall.html`

`http://`: 스킴(어떻게)
`www.joes-hardware.com`: 호스트(어디에)
`seasonal/index-fall.html`: 경로(무엇을)

URL은 당신과 브라우저에게 정보 찾는데 필요한 모든 것을 제공하며 당신이 원하는 리소스가 어디에 위치하고 어떻게 가져오는지 정의한다.

# 2.2 URL 문법

스킴은 `http` 말고도 `FTP`, `SMTP` 등 여러 가지가 있다.
URL은 스킴에 따라 문법이 달라진다. (하지만 비슷함)

`<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>`

대부분의 URL 스킴의 문법은 이렇게 9개의 부분으로 나뉘지만 이 모든 컴포넌트를 가지는 URL은 거의 없다. 가장 중요한 것은 스킴, 호스트, 경로다.

| 컴포넌트   | 설명                                                                                                   | 기본값       |
| ------ | ---------------------------------------------------------------------------------------------------- | --------- |
| 스킴     | 리소스를 가져오려면 어떤 프로토콜을 사용하여 서버에 접근해야 하는지 가리킴                                                            | 없음        |
| 사용자 이름 | 몇몇 스킴은 리소스에 접근을 하기 위해 사용자 이름을 필요로 함                                                                  | anonymous |
| 비밀번호   | 사용자의 비밀번호를 가리키며 사용자 이름에 콜론(:)으로 이어서 기술                                                               | <이메일 주소>  |
| 호스트    | 리소스를 호스팅하는 서버의 호스트 명이나 IP 주소                                                                         | 없음        |
| 포트     | 리소스를 호스팅하는 서버가 열어 놓은 포트 번호. 많은 스킴이 기본 포트를 가지고 있다. (HTTP의 경우 80)                                      | 스킴에 따라 다름 |
| 경로     | 이전 컴포넌트와 빗금(/)으로 구분. 서버 내 리소스가 서버 어디에 있는지를 가리킴. 경로 컴포넌트의 문법은 서버와 스킴에 따라 다름.                          | 없음        |
| 파라미터   | 특정 스킴들에서 입력 파라미터를 기술하는 용도로 사용. 여러 개 가질 수 있음                                                          | 없음        |
| 질의     | 스킴에서 애플리케이션(DB, 게시판, 검색엔진, 기타 인터넷 게이트웨이)에 파라미터를 전달하는 데 쓰임. `?`로 구분                                   | 없음        |
| 프래그먼트  | 리소스의 조각이나 일부분을 가리키는 이름. URL이 특정 객체를 가리킬 경우에 프래그먼트 필드는 서버에 전달되지 않는다. 이는 클라이언트에서만 사용. URL 끝에서 `#`으로 구분 | 없음        |

# 2.3 단축 URL

## 2.3.1 상대 URL

URL은 상대 URL과 절대 URL 두 가지로 나뉜다.
절대 URL은 리소스에 접근하는 데 필요한 모든 정보를 가지고 있다.
상대 URL은 모든 정보를 담고 있지는 않다. 모든 정보를 얻기 위해서 기저 URL을 사용해야 한다.
상대 URL은 URL을 짧게 표기하는 방식이다.

예시)
기저 URL: `http://www.joes-hardware.com`
상대 URL: `./hammers.html`
새로운 절대 URL: `http://www.joes-hardware.com/hammers.html`

상대 URL은 프래그먼트이거나 URL의 일부다.
URL을 처리하는 브라우저 같은 애플리케이션은 상대 URL과 절대 URL 간에 상호 변환을 할 수 있어야 한다.

- 변환 과정

![[Relative URL.png]]

## 2.3.2 URL 확장

사용자가 빠르게 URL을 입력하게 도와줌.
이러한 확장은 두 가지로 나뉨

- 호스트 명 확장
	naver만 입력해도 `www.naver.com`을 채워줌
	호스트 명 확장은 프락시와 같은 다른 HTTP 애플리케이션에서 문제를 발생시킬 수 있음(6장에서 자세히)

- 히스토리 확장
	사용자가 방문했던 URL의 기록을 저장함. 사용자가 다 입력 안 해도 앞 글자를 포함하는 URL을 선택하게 해줌
	프락시를 사용할 경우 다르게 동작할 수 있음(6장에서 자세히)

# 2.4 안전하지 않은 문자

URL 설계자들은 모든 인터넷 프로토콜로 URL이 전송될 수 있으면서 가독성도 있길 바람.
따라서 출력이 되지 않거나 보이지 않는 문자를 사용할 수 있거나 변환될 수 있다고 해서 URL에 그런 문자를 사용하는 것은 금지됨

사람들이 이진 데이터나 일반적으로 안전한 알파벳 외의 문자도 포함하려고 해서 이스케이프라는 기능을 추가해 안전하지 않은 문자를 안전한 문자로 인코딩할 수 있게 함.

## 2.4.2 인코딩 체계

안전하지 않은 문자를 `%`로 시작해 ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 이스케이프 문자로 바꾼다.

예시)

| 문자   | ASCII | URL 예시                                         |
| ---- | ----- | ---------------------------------------------- |
| ~    | 0x7E  | `http://www.naver.com/%7E`                     |
| 빈 문자 | 0x20  | `http://www.naver.com/more%20tools.html`       |
| %    | 0x25  | `http://www.naver.com/100%25satisfaction.html` |

## 2.4.3 문자 제한

몇몇 문자는 URL 내에서 특별한 의미로 예약됨.

| 문자                    | 선점 및 제한                            |
| --------------------- | ---------------------------------- |
| `%`                   | 인코딩된 문자에 사용할 이스케이프 토큰으로 선점         |
| `/`                   | 경로 컴포넌트에 있는 경로 세그먼트를 나누는 용도로 선점    |
| `.`, `..`             | 경로 컴포넌트에서 선점                       |
| `#`                   | 프래그먼트의 구획 문자로 선점                   |
| `?`                   | 질의 문자열의 구획 문자로 ㅅ너점                 |
| `;`                   | 파라미터의 구획 문자로 선점                    |
| `:`                   | 스킴, 사용자 이름/비밀번호, 호스트/포트의 구획 문자로 선점 |
| `$ , + @ & =`         | 선점                                 |
| `{ } \| ~ [ ] < >` 등등 | 안전하지 않음                            |
자세한 내용은 `https://www.ietf.org/rfc/rfc2396.txt` 여기에서 확인 가능

## 2.4.4 좀 더 알아보기

예를 들어 `http://www.naver.com/~etc` 이런 URL에 접속이 가능한 경우도 있다.
어떤 전송 프로토콜에서는 이것이 별 문제가 되지 않기는 하지만 애플리케이션 개발자들이 안전하지 않은 문자를 인코딩하지 않는 것은 실수다.

# 2.5 스킴의 바다

대표적인 스킴 예시

| 스킴          | 설명                                                                                                                                                                                                                                                            |
| ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| http        | 사용자 이름이나 비밀번호가 없다는 것을 제외하고는 일반 URL 포맷을 지키는 하이퍼텍스트 전송 프로토콜 스킴. 포트 생략 시 기본 값은 80<br>ex) `http://www.naver.com/index.html`                                                                                                                                       |
| https       | http와 거의 같음. https는 HTTP의 커넥션의 양 끝단에서 암호화를 위해 넷스케이프에서 개발한 보안 소켓 계층(Secure Sockets Layer, SSL)을 사용함. 기본 포트는 443<br>ex) `https://www.naver.com`                                                                                                                 |
| mailto      | 이메일 주소를 가리킴. 이메일은 다른 스킴과는 다르게 동작하기에 표준 URL과는 다른 포맷을 가짐.<br>ex) `mailto:example@example.com`                                                                                                                                                                   |
| ftp         | 파일 전송 프로토콜(File Transfer Protocol)은 FTP 서버에 있는 파일을 내려 받거나 올리고 FTP 서버의 디렉터리에 있는 컨텐츠 목록을 가져오는 데 사용 가능<br>FTP는 웹과 URL 출현 이전부터 존재.<br>`ftp://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>`<br>ex) `ftp://anonymous:joe%40joes-hardware.com@prep.ai.mit.edu:21/pub/gnu/` |
| rtsp, rtspu | RTSP는 실시간 스트리밍 프로토콜(Real Time Streaming Protocol)을 통해 읽을 수 있는 오디오 및 비디오와 같은 미디어 리소스 식별자<br>`rtsp://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>`<br>ex) `rtsp://www.joes-hardware.com:554/interview/cto_video`                                                             |
| file        | file 스킴은 주어진 호스트 기기에서 바로 접근할 수 있는 파일들을 나타냄. 각 필드도 일반적인 URL 포맷을 따름. 만약 호스트가 생략되어 있으면 로컬 호스트가 기본 값임<br>ex) `file://OFFICE-FS/policies/casual-fridays.doc`                                                                                                       |
| news        | RFC 1036에 정의됨. 뉴스 그룹에 접근하는 데 사용. 리소스의 위치 정보를 충분히 포함하지 않음. 정보를 알아내는 것은 애플리케이션의 몫.<br>ex) `news:rec.arts.startrek`                                                                                                                                              |
| telnet      | 대화형 서비스에 접근하는 데 사용. telnet URL 자체가 객체를 가리키지는 않지만 리소스라고 할 수 있는 대화형 애플리케이션은 telnet 프로토콜을 통해 접근 가능<br>`telnet://<사용자 이름>:<비밀번호>@<호스트>:<포트>/`<br>ex) `telnet://slurp:webhound@joes-hardware.com:23/`                                                              |

# 2.6 미래

URL은 특정 시점에 어떤 것이 위치한 곳을 알려주는 것임. 즉 리소스가 옮겨지면 URL을 더는 사용할 수 없음.

이상적인 방법은 객체의 위치와 상관 없이 그 객체를 가리키는 실제 객체의 이름을 사용하는 것. 고심 끝에 URN(Uniform Resource Names)라는 새로운 표준 작업에 착수. URN은 객체가 옮겨지더라도 항상 객체를 가리킬 수 있는 이름을 제공.

Persistent Uniform Resource Locators(PURL) 사용 시 URL로 URN의 기능을 제공 가능.
리소스의 실제 URL 목록을 관리하고 추적하는 리소스 위치 중개 서버를 두고 해당 리소스를 우회적으로 제공.
클라이언트는 위치 할당자에게 리소스를 가져올 수 있는 영구적인 URL을 요청 가능. 영구적인 URL은 클라이언트를 리소스의 실제 URL로 연결해 줌.
`https://purl.archive.org/` 참고

## 2.6.1 지금 아니면 언제?

한동안 URN 방식이 활용되었지만 URL에서 URN으로 주소 체계를 바꾸는 것은 매우 큰 작업이다.
표준화는 매우 중요한 작업인 만큼 느리게 진행될 때도 있다.
URN으로 전환하기 위한 모든 것이 준비되려면 시간이 걸리기에 URL은 계속 사용될 것이다.
웹 개발 커뮤니티에서 이를 가장 긴급한 사안이라고 이야기하지 않는다.
